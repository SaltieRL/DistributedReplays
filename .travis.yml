sudo: required
language: python
python:
- "3.6"

services:
- docker
- postgresql
- redis-server

addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test

# command to install dependencies (docker in this case)
before_install:


install:
- pip install -r requirements.txt
- pip install -r requirements-test.txt
- ls
- cd webapp
- npm install

# command to run tests
script:
- cd $TRAVIS_BUILD_DIR
- cd webapp
- npm install
- npm start &
- cd $TRAVIS_BUILD_DIR
- celery -A backend.tasks.celery_tasks.celery worker --pool=solo -l info &

# test python
- pytest --cov=./ --ignore=protobuf-2.6.1/
# test react
- cd webapp
- npm test

after_success:
- codecov
